### EK TODO: Our own secrets: Necromancer, Vampire, communed with the Daedra, ...

#NOTE!
#When you add new secrets, make sure they're properly included in these scripted triggers:
# trait_is_shunned_in_faith_trigger
# trait_is_criminal_in_faith_trigger
# secret_is_shunned_in_faith_trigger
# secret_is_criminal_in_faith_trigger

#Also, all secrets should be added through their associated scripted effect/effects, not by the add_secret effect

#Note! Should only be added with "give_necromancer_secret_or_trait_effect"
secret_necromancer = {
	category = necromancy

	is_valid = {
		secret_necromancer_is_valid_trigger = {
			OWNER = scope:secret_owner
		}
	}

	is_shunned = {
		secret_necromancer_is_shunned_trigger = {
			OWNER = scope:secret_owner
		}
	}

	is_criminal = {
		secret_necromancer_is_criminal_trigger = {
			OWNER = scope:secret_owner
		}
	}

	
	on_expose = {
		save_scope_as = secret
		
		secret_exposed_notification_effect = yes

		scope:secret_owner = {
			if = {
				limit = {
					NOT = {
						this = scope:secret_exposer
					}
				}
				save_scope_as = owner
				add_trait = necromancer
				### EK TODO: That
				#trigger_event = secrets.0007
			}
		}
	}
}

#Note! Should only be added with "give_vampire_secret_or_trait_effect"
secret_vampire = {
	category = vampire

	is_valid = {
		secret_vampire_is_valid_trigger = {
			OWNER = scope:secret_owner
		}
	}

	is_shunned = {
		secret_vampire_is_shunned_trigger = {
			OWNER = scope:secret_owner
		}
	}

	is_criminal = {
		secret_vampire_is_criminal_trigger = {
			OWNER = scope:secret_owner
		}
	}

	
	on_expose = {
		save_scope_as = secret
		
		secret_exposed_notification_effect = yes

		scope:secret_owner = {
			if = {
				limit = {
					NOT = {
						this = scope:secret_exposer
					}
				}
				save_scope_as = owner
				### EK TODO: That
				#trigger_event = secrets.0007
			}
			if = {
				limit = {
					NOT = { has_trait = vampire_character }
				}
				add_trait = vampire_character
			}
			if = {
				limit = {
					has_trait = reclusive_vampire
				}
				remove_trait = reclusive_vampire
			}
			if = {
				limit = {
					has_character_modifier = secret_vampire_modifier
				}
				remove_character_modifier = secret_vampire_modifier
			}
		}
	}
}

#Note! Should only be added with "give_lycan_secret_or_trait_effect"
secret_lycan = {
	category = lycan

	is_valid = {
		secret_lycan_is_valid_trigger = {
			OWNER = scope:secret_owner
		}
	}

	is_shunned = {
		secret_lycan_is_shunned_trigger = {
			OWNER = scope:secret_owner
		}
	}

	is_criminal = {
		secret_lycan_is_criminal_trigger = {
			OWNER = scope:secret_owner
		}
	}

	
	on_expose = {
		save_scope_as = secret
		
		secret_exposed_notification_effect = yes

		scope:secret_owner = {
			if = {
				limit = {
					NOT = {
						this = scope:secret_exposer
					}
				}
				save_scope_as = owner
				### EK TODO: That
				#trigger_event = secrets.0007
			}
			if = {
				limit = {
					has_trait = irritable_lycan
				}
				remove_trait = irritable_lycan
			}
			if = {
				limit = {
					has_character_modifier = secret_lycan_modifier
				}
				remove_character_modifier = secret_lycan_modifier
			}
			if = {
				limit = {
					NOT = { has_trait = lycan_character }
				}
				add_trait = lycan_character
			}
		}
	}
}
